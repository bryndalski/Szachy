<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: templates/CreateLobbyAlert.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: templates/CreateLobbyAlert.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";

import BasicLobby from "../BasicLobby.js";
export default class CreateLobbyAlert extends BasicLobby {
  constructor() {
    super();
    this.eventEmiter = new CustomEvent("alertFire");
    this.fired = false;
    this.alertListener();
  }

  /**
   * Listens to button click
   */
  clickListen = () => {
    document.body.insertAdjacentHTML("beforeend", this.fire());
  };
  /**
   *
   * @param {event} e validates data from input on live typing
   */
  inputValidator = (e) => {
    if (e.target.value.replace(/\s\s+/g, " ").length &lt; 3) {
      e.target.style.borderColor = "#dc3545";
      document
        .querySelector(".alertControlls button:first-child")
        .removeEventListener("click", this.joinLobby);
      document.querySelector(
        ".alertControlls button:first-child"
      ).disabled = true;
    } else {
      e.target.style.borderColor = "#0d6efd";
      document
        .querySelector(".alertControlls button:first-child")
        .addEventListener("click", this.joinLobby);
      document.querySelector(
        ".alertControlls button:first-child"
      ).disabled = false;
    }
  };

  /**
   * Send data of new room
   */
  joinLobby = () => {
    let inputs = Array.from(document.querySelectorAll(".options input"));
    console.log(inputs[1].checked);
    fetch("/addRoom", {
      method: "post",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        name: inputs[0].value,
        passwordRequired: inputs[1].checked,
        password: inputs[2].value,
      }),
    })
      .then((response) => response.json())
      .then((data) => {
        if (data.success) {
          console.log("Essa");
          window.location.href = "/game";
        }
      });
    this.atomize();
  };
  /**
   *Listens to alert fire action on listener
   */
  alertListener() {
    window.addEventListener("alertFire", () => {
      //disable button
      document.querySelector(".createHeader button").disabled = false;
      //password
      document
        .querySelector(".form-check-input")
        .addEventListener("change", this.listenPassInputRequirement);
      //alert gone
      document
        .querySelector(".plachta")
        .addEventListener("click", this.atomize);
      //submit button
      document
        .querySelector(".alertControlls button:first-child")
        .addEventListener("click", this.joinLobby);
      //cansel button
      document
        .querySelector(".alertControlls button:nth-child(2)")
        .addEventListener("click", this.atomize);
      document.querySelector(".createHeader button").disabled = false;
      //password type password
      document
        .querySelector(".passer")
        .addEventListener("input", this.inputValidator);
      //login validate
      document
        .querySelector(".options input:first-child")
        .addEventListener("input", this.inputValidator);
    });
  }
  /**
   * listens if room requires password or not
   * @css
   */
  listenPassInputRequirement = (e) => {
    let label = document.querySelector(".form-check-label");
    let passInput = document.querySelector(".passer");
    if (e.target.checked) {
      label.innerText = "Hasło";
      passInput.style.visibility = "visible";
      passInput.disabled = false;
      document
        .querySelector(".passer")
        .addEventListener("input", this.inputValidator);
    } else {
      document
        .querySelector(".passer")
        .removeEventListener("input", this.inputValidator);
      label.innerText = "Brak hasła";
      passInput.style.visibility = "hidden";
      passInput.disabled = true;
    }
  };
  /**
   * Fires lobby create page
   * @returns {HTMLDivElement} LobbyAlert
   * @emits alertFire
   */
  fire() {
    this.fired = true;
    this.sleep(10).then((v) => dispatchEvent(this.eventEmiter));
    return `
    &lt;div class="plachta">&lt;/div>
    &lt;div class="addRoom">
        &lt;span>Alert Name&lt;/span>
        &lt;div class="options">
          &lt;input
            type="text"
            name="roomName"
            placeholder="Room name"
            maxlength="20"
            minlength="3"
            required
          />
          &lt;div class="form-check form-switch pl-0 d-flex flex-column">
           &lt;input class="form-check-input " type="checkbox" checked >
            &lt;label 
            class="form-check-label"
            for="form-check-input"
            disabled
    
              >Hasło&lt;/label
            >
          &lt;/div>
          &lt;form>
          &lt;input type="password" placeholder="Password" class="passer" autocomplete="off" />
          &lt;/form>
          &lt;div class="alertControlls">
            &lt;button disabled>Join&lt;/button>
            &lt;button>Chanel&lt;/button>
          &lt;/div>
      &lt;/div>`;
  }
  /**
   * Removes alert dialog and all components created with it
   * @warning DOES NOT SEND ANDY DATA
   */
  atomize() {
    //enables button
    document.querySelector(".createHeader button").disabled = false;
    //remove input password requirement listener
    document
      .querySelector(".form-check-input")
      .removeEventListener("change", this.listenPassInputRequirement);
    //remove plachta listener
    document
      .querySelector(".plachta")
      .removeEventListener("click", this.atomize);
    //remove elements from button
    document
      .querySelector(".alertControlls button:first-child")
      .removeEventListener("click", this.joinLobby);
    //dismiss button
    document
      .querySelector(".alertControlls button:nth-child(2)")
      .removeEventListener("click", this.atomize);
    //password valdator
    document
      .querySelector(".passer")
      .removeEventListener("input", this.inputValidator);
    //name valdator
    document
      .querySelector(".options input:first-child")
      .removeEventListener("input", this.inputValidator);
    document.body
      .querySelector(".addRoom")
      .parentNode.removeChild(document.body.querySelector(".addRoom"));
    document.body.removeChild(document.querySelector(".plachta"));
  }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module.exports.html">exports</a></li><li><a href="module.exports_module.exports.html">exports</a></li><li><a href="ScrollBehavior.html">ScrollBehavior</a></li><li><a href="TableSelect.html">TableSelect</a></li></ul><h3>Events</h3><ul><li><a href="global.html#event:screllDown">screllDown</a></li></ul><h3>Global</h3><ul><li><a href="global.html#alertListener">alertListener</a></li><li><a href="global.html#atomize">atomize</a></li><li><a href="global.html#buildUserize">buildUserize</a></li><li><a href="global.html#closeListen">closeListen</a></li><li><a href="global.html#collectPage">collectPage</a></li><li><a href="global.html#connectScokets">connectScokets</a></li><li><a href="global.html#customListen">customListen</a></li><li><a href="global.html#customListenersRemover">customListenersRemover</a></li><li><a href="global.html#filtrate">filtrate</a></li><li><a href="global.html#fire">fire</a></li><li><a href="global.html#hugeScrean">hugeScrean</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#listenSockets">listenSockets</a></li><li><a href="global.html#removeScrollListen">removeScrollListen</a></li><li><a href="global.html#render">render</a></li><li><a href="global.html#responsive">responsive</a></li><li><a href="global.html#scrollDown">scrollDown</a></li><li><a href="global.html#scrollListen">scrollListen</a></li><li><a href="global.html#scrollUp">scrollUp</a></li><li><a href="global.html#sleep">sleep</a></li><li><a href="global.html#smallScreen">smallScreen</a></li><li><a href="global.html#userize">userize</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Fri Jun 11 2021 15:42:03 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
